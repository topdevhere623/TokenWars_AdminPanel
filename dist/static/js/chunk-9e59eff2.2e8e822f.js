(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9e59eff2"],{"7ab3":function(e,t,r){"use strict";r("d522")},a418:function(e,r,a){"use strict";a.r(r);a("b680");var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-wrapper"},[t("div",{staticClass:"public-list-inputs"},[t("el-input",{staticClass:"public-input",staticStyle:{width:"220px"},attrs:{placeholder:"Enter ID, name",clearable:""},model:{value:e.obscureField,callback:function(t){e.obscureField=t},expression:"obscureField"}}),t("el-button",{staticClass:"public-search",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.fetchNftPlatformList()}}},[e._v(" Inquire ")]),t("el-button",{staticClass:"public-search",attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.showDialog=!0}}},[e._v(" Create NFT ")])],1),t("div",{staticClass:"remittance-box"},[t("div",{staticClass:"remittance-amount remittance-more"},[t("div",{staticClass:"remittance-item"},[t("div",{staticClass:"title"},[e._v("Total collection")]),t("div",{staticClass:"val"},[e._v(e._s(e.aggregateQuery&&e.aggregateQuery.collNumberTotal))])])])]),t("el-table",{staticClass:"public-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"sort-change":e.sortChange}},[t("el-table-column",{key:"1",attrs:{prop:"id",sortable:"custom",label:"nft ID",align:"center"}}),t("el-table-column",{key:"2",attrs:{prop:"seriesImg",label:"NFT diagram",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("div",{staticStyle:{width:"100px",height:"100px"}},[t("el-image",{staticStyle:{height:"100%"},attrs:{src:e.row.seriesImg,"preview-src-list":[e.row.seriesImg]}})],1)]}}])}),t("el-table-column",{key:"3",attrs:{prop:"seriesType",label:"type",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("COIN"==t.row.seriesType?"币":"图")+" ")]}}])}),t("el-table-column",{key:"4",attrs:{prop:"seriesName",label:"Series name",align:"center"}}),t("el-table-column",{key:"5",attrs:{prop:"chainType",label:"Chain",align:"center"}}),t("el-table-column",{key:"6",attrs:{prop:"tokenId",label:"tokenId",align:"center"}}),t("el-table-column",{key:"7",attrs:{prop:"price",sortable:"custom",label:"value(".concat("eth",")"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("COIN"==t.row.seriesType?t.row.price:"--")+" ")]}}])}),t("el-table-column",{key:"8",attrs:{prop:"price",sortable:"custom",label:"Value ($ {coin})",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("COIN"==t.row.seriesType?(t.row.usdtLastPrice*t.row.price).toFixed(4):t.row.price)+" ")]}}])}),t("el-table-column",{key:"9",attrs:{prop:"contractAddress",label:"contract",align:"center"}}),t("el-table-column",{key:"10",attrs:{prop:"relevancyBoxNumber",sortable:"custom",label:"Associated blind box",align:"center"}}),t("el-table-column",{key:"11",attrs:{prop:"openNumberTotal",sortable:"custom",label:"Quantity",align:"center"}}),t("el-table-column",{key:"12",attrs:{prop:"openPriceTotal",sortable:"custom",label:"Global value",align:"center"}}),t("el-table-column",{key:"13",attrs:{prop:"sellNumberTotal",sortable:"custom",label:"Resale quantity",align:"center"}}),t("el-table-column",{key:"14",attrs:{prop:"sellPriceTotal",sortable:"custom",label:"Total value of resale",align:"center"}}),t("el-table-column",{key:"15",attrs:{prop:"outNumberTotal",sortable:"custom",label:"Quantity",align:"center"}}),t("el-table-column",{key:"16",attrs:{prop:"relevancyUserNumber",sortable:"custom",label:"User hold",align:"center"}}),t("el-table-column",{key:"17",attrs:{prop:"relevancyFoundryNumber",sortable:"custom",label:"Casting quantity",align:"center"}}),t("el-table-column",{key:"18",attrs:{prop:"reclaimRate",sortable:"custom",label:"Recycling ratio",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("".concat(new e.bigNumber(t.row.reclaimRate||0).multipliedBy(100).toFixed(2),"%"))+" ")]}}])}),t("el-table-column",{key:"19",attrs:{prop:"id",label:"operate",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return["PIC"==r.row.seriesType?t("span",{staticClass:"blueColor publick-button cursor",on:{click:function(t){return e.approve(r.row)}}},[e._v(" Authorize ")]):e._e(),t("span",{staticClass:"blueColor publick-button cursor",on:{click:function(t){return e.handleEdit(r.row)}}},[e._v(" edit ")]),t("span",{staticClass:"blueColor publick-button cursor",on:{click:function(t){return e.handleDel(r.row)}}},[e._v(" delete ")])]}}])})],1),e.baseUserPage&&e.baseUserPage.total?t("el-pagination",{staticClass:"public-pagination",attrs:{background:"","current-page":e.page,"page-sizes":e.pagination.pageSizes,"page-size":e.size,layout:" sizes, prev, pager, next, jumper",total:e.baseUserPage.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e(),e.showDialog?t("el-dialog",{attrs:{title:1==e.operatingType?"Create NFT":"Edit NFT",visible:e.showDialog,width:"540px","close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.showDialog=t}}},[t("el-form",{ref:"ruleForm",staticClass:"add-form",attrs:{rules:e.rules,model:e.ruleForm,"label-width":"130px"}},[t("el-form-item",{attrs:{label:"name",prop:"seriesName"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{disabled:"COIN"!==e.ruleForm.seriesType&&1!=e.operatingType,placeholder:"Please enter the name"},model:{value:e.ruleForm.seriesName,callback:function(t){e.$set(e.ruleForm,"seriesName",t)},expression:"ruleForm.seriesName"}})],1),t("el-form-item",{attrs:{label:"type",prop:"seriesType"}},[t("el-select",{staticStyle:{width:"300px"},attrs:{disabled:1!=e.operatingType,placeholder:"Please choose the type"},model:{value:e.ruleForm.seriesType,callback:function(t){e.$set(e.ruleForm,"seriesType",t)},expression:"ruleForm.seriesType"}},[t("el-option",{attrs:{label:"currency",value:"COIN"}}),t("el-option",{attrs:{label:"picture",value:"PIC"}})],1)],1),t("el-form-item",{attrs:{label:"Contract address",prop:"contractAddress"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{disabled:"COIN"!==e.ruleForm.seriesType&&1!=e.operatingType,placeholder:"Please enter the contract address"},model:{value:e.ruleForm.contractAddress,callback:function(t){e.$set(e.ruleForm,"contractAddress",t)},expression:"ruleForm.contractAddress"}},[t("template",{slot:"append"},[t("el-button",{on:{click:function(t){return e.fetchNftSeries()}}},[e._v("Inquire")])],1)],2)],1),"COIN"!==e.ruleForm.seriesType?[t("el-form-item",{attrs:{label:"tokenId",prop:"tokenId"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{disabled:1!=e.operatingType,placeholder:"Please enter tokenId"},model:{value:e.ruleForm.tokenId,callback:function(t){e.$set(e.ruleForm,"tokenId",t)},expression:"ruleForm.tokenId"}})],1)]:[t("el-form-item",{attrs:{label:"Currency",prop:"seriesCoin"}},[t("el-select",{staticStyle:{width:"300px"},attrs:{disabled:1!=e.operatingType},model:{value:e.ruleForm.seriesCoin,callback:function(t){e.$set(e.ruleForm,"seriesCoin",t)},expression:"ruleForm.seriesCoin"}},[t("el-option",{attrs:{label:"eth",value:"ETH"}})],1)],1)],t("el-form-item",{attrs:{label:"picture",prop:"seriesImg"}},[t("el-upload",{class:{hide:e.hideUpload},attrs:{disabled:"COIN"!==e.ruleForm.seriesType&&1!=e.operatingType,action:e.uploadUrl,"on-change":e.handleChange,"on-success":e.handleUpload,"file-list":e.fileImg,multiple:!1,limit:1,accept:"image/png,image/jpg,image/jpeg,image/gif,image/webp","list-type":"picture-card","before-upload":e.handleBefore,"on-remove":e.handleRemove,"on-exceed":e.handExceed,headers:e.uploadHeader}},[t("i",{staticClass:"el-icon-plus"})])],1),t("el-form-item",{attrs:{label:"Chain",prop:"chainId"}},[t("el-select",{staticStyle:{width:"300px"},attrs:{disabled:"COIN"!==e.ruleForm.seriesType&&1!=e.operatingType},model:{value:e.ruleForm.chainId,callback:function(t){e.$set(e.ruleForm,"chainId",t)},expression:"ruleForm.chainId"}},e._l(e.chainList,(function(r,a){return t("el-option",{key:a,attrs:{label:r.chainName,value:r.chainId}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(r.chainName))]),t("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(e._s(r.type))])])})),1)],1),t("el-form-item",{attrs:{label:"value",prop:"price"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{disabled:"COIN"!==e.ruleForm.seriesType&&1!=e.operatingType,type:"number",placeholder:"Please enter value"},model:{value:e.ruleForm.price,callback:function(t){e.$set(e.ruleForm,"price",t)},expression:"ruleForm.price"}},[t("template",{slot:"append"},[e._v(e._s("COIN"==e.ruleForm.seriesType?"ETH":"USDT"))])],2)],1),t("el-form-item",{attrs:{label:"Recycling ratio",prop:"reclaimRate"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{type:"number",placeholder:"Please enter the recycling ratio"},model:{value:e.ruleForm.reclaimRate,callback:function(t){e.$set(e.ruleForm,"reclaimRate",t)},expression:"ruleForm.reclaimRate"}},[t("template",{slot:"append"},[e._v("%")])],2)],1)],2),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.handleClose()}}},[e._v("Cancel")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v("Sure")])],1)],1):e._e()],1)},s=[],n=a("5530"),i=a("c7eb"),o=a("1da1"),c=(a("d9e2"),a("14d9"),a("b0c0"),a("d3b7"),a("4d63"),a("c607"),a("ac1f"),a("2c3e"),a("00b4"),a("25f0"),a("bc3a")),u=a.n(c),p=a("901e"),d=a.n(p),m=a("ed08"),h=a("1b80"),f=a("51be"),b=a("0acd"),g=a("a938"),y=a("f31c"),v=a("c0d8"),w=a.n(v),k=a("eb57"),C={name:"PlatformNftSeries",components:{},data:function(){var e=function(e,t,r){var a=new RegExp(/^(100|[1-9]?\d(\.\d\d?\d?)?)$|0$/);a.test(t)?r():r(new Error("Please enter a percentage of 0-100"))};return{walletAddress:"",showDialog:!1,obscureField:null,sortData:{orderBy:null,orderType:null},page:1,size:20,tableData:null,aggregateQuery:{},baseUserPage:null,uploadUrl:"",fileImg:[],limitCount:1,hideUpload:!1,uploadHeader:{certificate:sessionStorage.getItem("token")},operatingType:1,ruleForm:{tokenId:void 0,contractAddress:"",chainId:void 0,coin:"ETH",seriesCoin:"ETH",price:null,seriesName:null,seriesType:null,seriesImg:null,reclaimRate:null},rules:{tokenId:[{required:!0,message:"Please enter tokenId",trigger:["blur","change"]}],contractAddress:[{required:!0,message:"Please enter the contract address",trigger:["blur","change"]}],chainId:[{required:!0,message:"Please select the chain",trigger:["blur","change"]}],price:[{required:!0,message:"Please enter value",trigger:["blur","change"]}],seriesName:[{required:!0,message:"Please enter the name",trigger:["blur","change"]}],seriesType:[{required:!0,message:"Please choose the type",trigger:["blur","change"]}],seriesImg:[{required:!0,message:"Please select NFT pictures",trigger:["blur","change"]}],reclaimRate:[{required:!0,message:"Please enter the recycling ratio",trigger:["blur","change"]},{validator:e,trigger:["blur","change"]}]},chainList:b["a"]}},mixins:[h["a"]],methods:{bigNumber:d.a,timeForStr:m["h"],sortChange:function(e){e.column;var t=e.prop,r=e.order;this.sortData.orderBy=t,this.sortData.orderType="descending"==r?"DESC":"ASC",r||(this.sortData.orderType=null),this.fetchNftPlatformList()},connectMetaMask:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function r(){var a,l,s;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:a=e,l=new w.a(window.ethereum),s=window.ethereum,"undefined"===typeof s?openUrl("https://metamask.app.link/dapp/".concat(window.location.origin)):s.enable().then(function(){var e=Object(o["a"])(Object(i["a"])().mark((function e(t){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:l=new w.a(window.ethereum),l.eth.defaultAccount=t[0],a.walletAddress=t[0];case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){"User rejected provider access"===e||ElMessage.error(t("airdrop.failedTips"))}));case 4:case"end":return r.stop()}}),r)})))()},approve:function(e){var t=this;return Object(o["a"])(Object(i["a"])().mark((function r(){var a,l,s,n,o,c,u;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.connectMetaMask();case 2:return r.next=4,window.ethereum.request({method:"eth_requestAccounts"});case 4:return r.sent,console.log(e,"item======"),a="ERC1155"==e.seriesNftType,l=new w.a(window.ethereum),s=e.contractAddress,n=t.walletAddress,o=new l.eth.Contract(a?y:g,s),c=k["a"].nftHelpAddress,r.next=14,o.methods.isApprovedForAll(n,c).call();case 14:if(u=r.sent,console.log(u,"isApproved==="),u){r.next=21;break}return r.next=19,o.methods.setApprovalForAll(c,!0).send({from:n});case 19:r.next=22;break;case 21:t.$message.success("isApproved");case 22:case"end":return r.stop()}}),r)})))()},fetchNftPlatformList:function(){var e=arguments,t=this;return Object(o["a"])(Object(i["a"])().mark((function r(){var a,l,s,o,c,u,p;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=!(e.length>0&&void 0!==e[0])||e[0],l=t.sortData,s=t.size,o=t.page,a&&(t.page=1,o=1),c=Object(n["a"])(Object(n["a"])({obscureField:t.obscureField},l),{},{size:s,page:o}),r.next=7,t.$http.getNftPlatformList(c);case 7:return u=r.sent,u&&(t.baseUserPage=u,t.tableData=u.records),delete c.size,delete c.page,r.next=13,t.$http.getNftExternalStatistics(c);case 13:p=r.sent,p&&(t.aggregateQuery=p);case 15:case"end":return r.stop()}}),r)})))()},handleEdit:function(e){this.ruleForm=Object(n["a"])({},e),this.fileImg=[{url:e.seriesImg}],this.ruleForm.reclaimRate=new d.a(this.ruleForm.reclaimRate).multipliedBy(100).toString(),this.hideUpload=!0,this.operatingType=2,this.showDialog=!0},handleDel:function(e){var t=this;this.$confirm('Are you sure to delete the series "'.concat(e.seriesname||e.id,'"?'),"hint",{confirmButtonText:"Sure",cancelButtonText:"Cancel",type:"info"}).then(Object(o["a"])(Object(i["a"])().mark((function r(){var a;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$http.nftPlatformDel({id:e.id});case 2:a=r.sent,a&&(t.fetchNftPlatformList(!0),t.$message.success("Successful operation"));case 4:case"end":return r.stop()}}),r)})))).catch((function(e){console.error(e)}))},handleClose:function(e){this.operatingType=1,this.ruleForm={tokenId:null,contractAddress:"",chainId:null,coin:"ETH",price:null,seriesName:null,seriesType:null,seriesImg:null,reclaimRate:null},e?e():this.showDialog=!1},handleUpload:function(e){if(200==e.code)return this.fileImg.push({url:e.data}),void(this.ruleForm.seriesImg=e.data);this.$message.error("upload failed")},handleBefore:function(e){var t=this,r=e.size/1024/1024<2;return r||t.$message.error("The file is too large, and the file size is less than 2M"),r},handleChange:function(e,t){this.hideUpload=t.length>=this.limitCount},handleRemove:function(e,t){this.hideUpload=t.length>=this.limitCount,this.fileImg=[]},handExceed:function(e){this.$message.error("File can only upload one")},fetchNftSeries:function(){var e=this,t=this.ruleForm,r=t.chainId,a=t.contractAddress;if(r){var l=f["a"].api+"/nft-external-series/assetContract/goerli/";1==r&&(l=f["a"].api+"/nft-external-series/assetContract/eth/"),u.a.get(l+a,{responseType:"json",headers:{"X-API-KEY":"3eb9844d094945f288c104c770365ac8",certificate:sessionStorage.getItem("token")}}).then((function(t){if(200==t.status){var r=t.data;return e.fileImg=[{url:r.image_url}],e.ruleForm.seriesName=r.name,e.ruleForm.seriesImg=r.image_url,void(e.ruleForm.keywords=r.collection.slug)}e.$message.error("Inquiry fails, please check whether the contract address is correct")})).catch((function(t){e.$message.error("Inquiry fails, please check whether the contract address is correct"),console.log(t)}))}else this.$message.warning("Please select the network")},submitForm:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(o["a"])(Object(i["a"])().mark((function t(r){var a,l;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=22;break}if(a=Object(n["a"])({},e.ruleForm),1!=e.operatingType){t.next=7;break}if(0!=e.fileImg.length){t.next=6;break}return e.$message.error("Please upload the picture!"),t.abrupt("return");case 6:a.seriesImg=e.fileImg[0].url;case 7:if(a.reclaimRate=new d.a(a.reclaimRate).dividedBy(100),l=null,a.id){t.next=16;break}return"COIN"==a.seriesType?a.coin="ETH":a.coin="USDT",t.next=13,e.$http.nftPlatformAdd(Object(n["a"])({},a));case 13:l=t.sent,t.next=19;break;case 16:return t.next=18,e.$http.nftPlatformUpdate(Object(n["a"])({},a));case 18:l=t.sent;case 19:l&&(e.handleClose(),e.fetchNftPlatformList(),e.$refs["ruleForm"].resetFields(),e.$message.success("Successful operation!"),e.fileImg=[],e.hideUpload=!1),t.next=24;break;case 22:return console.log("error submit!!"),t.abrupt("return",!1);case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleSizeChange:function(e){this.size=e,this.fetchNftPlatformList()},handleCurrentChange:function(e){this.page=e,this.fetchNftPlatformList(!1)}},created:function(){this.fetchNftPlatformList(),this.uploadUrl=f["a"].api+"/file/upload/image"},computed:{coin:function(){return this.$store.getters.coinConfig},userType:function(){return this.$store.getters.accountConfig}},mounted:function(){},updated:function(){},beforeDestroy:function(){}},F=C,x=(a("7ab3"),a("2877")),T=Object(x["a"])(F,l,s,!1,null,"4ab2fc63",null);r["default"]=T.exports},d522:function(e,t,r){},eb57:function(e,t,r){"use strict";t["a"]={MultiSign:"0xf5293915f239a8bd6b1fc00c3d5510abd6e97774",nftHelpAddress:"0x0636ac626382270f428d23aae75957418a5344fe"}}}]);