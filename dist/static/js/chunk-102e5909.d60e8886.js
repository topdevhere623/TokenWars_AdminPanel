(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-102e5909"],{"043a":function(e,t,n){},"0baa":function(e,t,n){"use strict";n("043a")},"2d0f":function(e,t,n){"use strict";n("3667")},3667:function(e,t,n){},6706:function(e,t,n){"use strict";n("a63c")},"892c":function(e,t,n){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"quillEditorBox"},[t("quill-editor",{ref:"newEditor",staticClass:"editor",attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1)},r=[],a=n("5530"),o=(n("a753"),n("8096"),n("14e1"),n("953d")),l=n("d4ec"),c=n("bee2"),s=n("8f33"),u=n("45eb"),d=n("7e84"),m=n("262e"),p=(n("99af4"),n("13d5"),n("d3b7"),o["Quill"].import("blots/block/embed")),h=o["Quill"].import("formats/link"),f=["height","width"],b=function(e){function t(){return Object(l["a"])(this,t),Object(s["a"])(this,t,arguments)}return Object(m["a"])(t,e),Object(c["a"])(t,[{key:"format",value:function(e,n){f.indexOf(e)>-1?n?this.domNode.setAttribute(e,n):this.domNode.removeAttribute(e):Object(u["a"])(Object(d["a"])(t.prototype),"format",this).call(this,e,n)}},{key:"html",value:function(){var e=this.value(),t=e.video;return'<a href="'.concat(t,'">').concat(t,"</a>")}}],[{key:"create",value:function(e){var n=Object(u["a"])(Object(d["a"])(t),"create",this).call(this,e);return n.setAttribute("controls","controls"),n.setAttribute("controlsList","nofullscreen"),n.setAttribute("type","video/mp4"),n.setAttribute("style","object-fit:fill;width: 100%;"),n.setAttribute("preload","auto"),n.setAttribute("playsinline","true"),n.setAttribute("x-webkit-airplay","allow"),n.setAttribute("x5-video-orientation","portraint"),n.setAttribute("x5-playsinline","true"),n.setAttribute("x5-video-player-fullscreen","true"),n.setAttribute("src",this.sanitize(e)),n}},{key:"formats",value:function(e){return f.reduce((function(t,n){return e.hasAttribute(n)&&(t[n]=e.getAttribute(n)),t}),{})}},{key:"sanitize",value:function(e){return h.sanitize(e)}},{key:"value",value:function(e){return e.getAttribute("src")}}])}(p);b.blotName="video",b.className="ql-video",b.tagName="video";var g=b,v=n("c7eb"),w=n("1da1"),x=(n("b0c0"),n("b64b"),n("51be")),k=x["a"].api,y={action:k+"file/upload/image",methods:"POST",token:sessionStorage.getItem("token"),name:"file",accept:"image/png, image/gif, image/jpeg, image/bmp, image/x-icon"},S=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]],F={image:function(){var e=this,t=this.container.querySelector("input.ql-image[type=file]");null===t&&(t=document.createElement("input"),t.setAttribute("type","file"),y.name&&t.setAttribute("name",y.name),t.setAttribute("accept",y.accept),t.classList.add("ql-image"),t.addEventListener("change",Object(w["a"])(Object(v["a"])().mark((function n(){var i,r;return Object(v["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:i=new FormData,i.append(y.name,t.files[0]),i.append("imageType","context_edit"),r=new XMLHttpRequest,r.open(y.methods,y.action,!0),r.setRequestHeader("certificate",y.token),r.onload=function(n){if(200===r.status){var i=JSON.parse(r.responseText),a=e.quill.getSelection(!0).index;e.quill.insertEmbed(a,"image",i.data),e.quill.setSelection(a+1)}t.value=""},r.upload.onloadstart=function(e){t.value=""},r.upload.onerror=function(e){},r.upload.onloadend=function(e){},r.send(i);case 11:case"end":return n.stop()}}),n)})))),this.container.appendChild(t)),t.click()},video:function(e){e?document.querySelector(".avatar-uploader-editor-video input").click():this.quill.format("video",!1)}},O={placeholder:"",theme:"snow",modules:{toolbar:{container:S,handlers:F}}};o["Quill"].register(g,!0);var j=o["Quill"].import("attributors/style/size");j.whitelist=["12px","14px","16px","18px","20px","24px","28px","32px","36px"],o["Quill"].register(j,!0);var C=o["Quill"].import("attributors/style/font"),T=["SimSun","SimHei","Microsoft-YaHei","KaiTi","FangSong"];C.whitelist=T,o["Quill"].register(C,!0);var A=[["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{align:[]}],[{size:j.whitelist}],[{font:T}],[{header:[1,2,3,4,5,6,!1]}],[{direction:"ltl"}],[{direction:"rtl"}],[{indent:"-1"},{indent:"+1"}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],["blockquote","code-block"],["clean"],["link","image","video"]],q={props:{content:{type:String,default:""}},data:function(){return{editorOption:Object(a["a"])(Object(a["a"])({},O),{},{modules:{toolbar:{container:A}}}),ruleForm:{content:""}}},components:{quillEditor:o["quillEditor"]},watch:{content:function(){this.ruleForm.content=this.content}},created:function(){this.ruleForm.content=this.content},mounted:function(){var e=this.$refs.newEditor.quill;e.format("color","#a9a4b4")},methods:{onEditorChange:function(e){e.quill;var t=e.html,n=e.text;this.ruleForm.content=t,this.ruleForm.contentText=n,this.$emit("change",this.ruleForm.content,this.ruleForm.contentText)}}},$=q,_=(n("0baa"),n("9f5f"),n("2877")),z=Object(_["a"])($,i,r,!1,null,"4c7efa59",null);t["a"]=z.exports},"9f5f":function(e,t,n){"use strict";n("be83")},a63c:function(e,t,n){},be83:function(e,t,n){},c22e:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content"},[t("div",{staticClass:"addBox"},[t("el-input",{staticClass:"inner",attrs:{placeholder:"Please enter the announcement title",clearable:"",oninput:"if(value.length > 300)value=value.slice(0, 300)"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getTableList.apply(null,arguments)}},model:{value:e.noticeTitle,callback:function(t){e.noticeTitle=t},expression:"noticeTitle"}}),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getTableList}},[e._v("search")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("Add an announcement")])],1),t("br"),t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.protocolList}},[t("el-table-column",{attrs:{prop:"id",label:"ID"}}),t("el-table-column",{attrs:{prop:"title",label:"title"}}),t("el-table-column",{attrs:{prop:"createTime",label:"Creation time"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.timeForStr(t.row.createTime,"YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),t("el-table-column",{attrs:{prop:"webTime",label:"release time"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.timeForStr(t.row.webTime,"YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),t("el-table-column",{attrs:{prop:"scope",label:"operate",width:"220",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleEditor(n.row)}}},[e._v("edit")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDel(n.row)}}},[e._v(" delete ")])]}}])})],1),t("el-pagination",{staticClass:"public-pagination",staticStyle:{"margin-top":"12px"},attrs:{layout:"total, sizes, prev, pager, next, jumper",background:"",total:e.pagination.total,"current-page":e.pagination.page,"page-sizes":e.pagination.pageSizes,"page-size":e.pagination.size},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e.dialogVisible?t("el-dialog",{attrs:{title:e.id?"Edit announcement":"Add an announcement",visible:e.dialogVisible,width:"1200px",top:"2vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("addNotice",{attrs:{id:e.id},on:{close:function(t){e.dialogVisible=!1},refresh:e.getTableList}})],1):e._e()],1)},r=[],a=n("c7eb"),o=n("1da1"),l=n("1b80"),c=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content mall-add"},[t("el-row",[t("el-col",{attrs:{span:23}},[t("el-form",{ref:"ruleForm",staticClass:"add-form",attrs:{rules:e.rules,model:e.ruleForm,"label-width":"130px"}},[t("el-form-item",{attrs:{label:"Title name",prop:"title"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"Please enter the name"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),t("el-form-item",{attrs:{label:"release time",prop:"title"}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"Selection date time"},model:{value:e.ruleForm.webTime,callback:function(t){e.$set(e.ruleForm,"webTime",t)},expression:"ruleForm.webTime"}})],1),t("el-form-item",{attrs:{label:"Cover",prop:"imgUrl",rules:e.rules.select}},[t("el-upload",{class:{hide:e.hideUpload},attrs:{action:e.uploadUrl,"on-change":e.handleChange,"on-success":e.handleUpload,"file-list":e.fileImg,multiple:!1,limit:1,accept:"image/png,image/jpg,image/jpeg,image/gif,image/webp","list-type":"picture-card","before-upload":e.handleBefore,"on-remove":e.handleRemove,"on-exceed":e.handExceed,headers:e.uploadHeader}},[t("i",{staticClass:"el-icon-plus"})])],1),t("el-form-item",{attrs:{label:"Announcement content",prop:"contentHtml"}},[t("quillEditor",{staticClass:"ql-editor",attrs:{content:e.ruleForm.contentHtml},on:{change:e.onEditorChange}})],1)],1)],1)],1),t("el-row",{staticStyle:{"margin-top":"20px"}},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.resetForm()}}},[e._v("Cancel")]),t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.submitCofirm()}}},[e._v("keep")])],1)],1)},s=[],u=n("5530"),d=(n("d9e2"),n("14d9"),n("a9e3"),n("ac1f"),n("00b4"),n("892c")),m=n("51be"),p=n("ed08"),h={name:"AddNotice",props:{id:{type:Number|String,default:!1}},data:function(){return{uploadHeader:{certificate:sessionStorage.getItem("token")},active:"en_US",ruleForm:{language:"en_US",title:"",content:"",webTime:"",contentHtml:"",forcedSwitch:0,importantSwitch:0},ruleForm2:{language:"zh_CN",title:"",imgUrl:"",content:"",contentHtml:"",forcedSwitch:0,importantSwitch:0},rules:{title:[{required:!0,message:"Please enter the activity name",trigger:"blur"},{min:1,max:300,message:"The length is 1 to 30 characters",trigger:"blur"}],contentHtml:[{required:!0,message:"Please enter the announcement content",trigger:"blur"}],forcedSwitch:[{required:!0,trigger:"blur"}],importantSwitch:[{required:!0,trigger:"blur"}]},timer:null,timer2:null,fileImg:[],limitCount:1,uploadUrl:"",hideUpload:!1}},components:{quillEditor:d["a"]},created:function(){var e=this.id;e?(this.getBannerInfo(e),this.hideUpload=!0):this.hideUpload=!1,this.uploadUrl=m["a"].api+"/file/upload/image"},methods:{getBannerInfo:function(e){var t=this;return Object(o["a"])(Object(a["a"])().mark((function n(){var i;return Object(a["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.getAnnouncementInfo({annId:e});case 2:i=n.sent,i&&(t.ruleForm=i,t.ruleForm.webTime&&(t.ruleForm.webTime=Object(p["h"])(t.ruleForm.webTime,"YYYY-MM-DD HH:mm:ss")),t.fileImg=[{url:t.ruleForm.imgUrl}]);case 4:case"end":return n.stop()}}),n)})))()},changeForced:function(e){this.ruleForm.forcedSwitch=e},changeImportant:function(e){this.ruleForm.importantSwitch=e},resetForm:function(){this.$emit("close"),this.$refs.ruleForm.resetFields()},onEditorChange:function(e,t){this.ruleForm.contentHtml=e,this.ruleForm.content=t},handleUpload:function(e){if(200==e.code)return this.fileImg.push({url:e.data}),void(this.ruleForm.imgUrl=e.data);this.$message.error("upload failed")},handleBefore:function(e){var t=this,n=e.size/1024/1024<2;return n||t.$message.error("The file is too large, and the file size is less than 2M"),n},handleChange:function(e,t){this.hideUpload=t.length>=this.limitCount},handleRemove:function(e,t){this.hideUpload=t.length>=this.limitCount,this.fileImg=[]},handExceed:function(e){this.$message.error("File can only upload one")},submitCofirm:function(){var e=this;return Object(o["a"])(Object(a["a"])().mark((function t(){return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.ruleForm.validate(function(){var t=Object(o["a"])(Object(a["a"])().mark((function t(n){var i,r,o;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:if(i=Object(u["a"])({},e.ruleForm),!e.id){t.next=10;break}return t.next=6,e.$http.updateAnnouncement(i);case 6:r=t.sent,r&&(e.$message.success("Successful operation!"),e.$emit("close"),e.$emit("refresh")),t.next=14;break;case 10:return t.next=12,e.$http.saveAnnouncement(i);case 12:o=t.sent,o&&(e.$message.success("Successful operation!"),e.$emit("close"),e.$emit("refresh"));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()}}},f=h,b=(n("2d0f"),n("6706"),n("2877")),g=Object(b["a"])(f,c,s,!1,null,"424ad3de",null),v=g.exports,w={name:"NoticeList",mixins:[l["a"]],components:{addNotice:v},data:function(){return{noticeTitle:null,protocolList:[],forcedSwitch:"",importantSwitch:"",pagination:{page:1,size:10,pageSizes:[10,20,40,60],total:0},dialogVisible:!1,id:null}},created:function(){this.getTableList()},methods:{timeForStr:p["h"],changeSwitch:function(e){var t=this,n=e.id,i=e.forcedSwitch;this.$http.setIsForcedSwitch({annId:n,isForced:0==i?1:0}).then((function(e){t.getTableList()}))},changeSwitch2:function(e){var t=this,n=e.id,i=e.importantSwitch;this.$http.setIsImportantSwitch({annId:n,isImportant:1==i?0:1}).then((function(e){t.getTableList()}))},timeFormate:function(e,t){return Object(p["h"])(e,t)},fetchGetBanner:function(){var e=this;return Object(o["a"])(Object(a["a"])().mark((function t(){var n;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.getAnnouncementList({title:e.noticeTitle,page:e.pagination.page,size:e.pagination.size});case 2:n=t.sent,n&&(e.protocolList=n.records,e.pagination.total=n.total);case 4:case"end":return t.stop()}}),t)})))()},getTableList:function(e){var t=this;return Object(o["a"])(Object(a["a"])().mark((function n(){return Object(a["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:e&&(t.pagination.page=1),t.fetchGetBanner();case 2:case"end":return n.stop()}}),n)})))()},handleAdd:function(){this.id=null,this.dialogVisible=!0},handleEditor:function(e){this.id=e.id,this.dialogVisible=!0},handleDel:function(e){var t=this;this.$confirm("Are you sure to perform this operation?","hint",{confirmButtonText:"Sure",cancelButtonText:"Cancel",type:"info"}).then(Object(o["a"])(Object(a["a"])().mark((function n(){var i;return Object(a["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.deleteAnnouncement({annId:e.id});case 2:i=n.sent,i&&(t.fetchGetBanner(),t.$message.success("Successful operation"));case 4:case"end":return n.stop()}}),n)})))).catch((function(e){console.error(e)}))},handleSizeChange:function(e){this.pagination.size=e,this.fetchGetBanner()},handleCurrentChange:function(e){this.pagination.page=e,this.fetchGetBanner()}}},x=w,k=(n("c78c"),Object(b["a"])(x,i,r,!1,null,"3abd5d02",null));t["default"]=k.exports},c78c:function(e,t,n){"use strict";n("eb10")},eb10:function(e,t,n){}}]);