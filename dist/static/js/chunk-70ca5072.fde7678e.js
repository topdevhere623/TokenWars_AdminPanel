(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70ca5072"],{"1c4c":function(e,t,r){},"5df0":function(e,t,r){"use strict";r("1c4c")},f44e:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content"},[t("div",{staticClass:"searchBox"},[t("div",{staticClass:"searchLeft"}),t("div",{staticClass:"searchRight"},[t("el-button",{attrs:{size:"medium",type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("Add banner")])],1)]),t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.protocolList}},[t("el-table-column",{attrs:{prop:"banner",label:"picture"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("div",{staticStyle:{width:"100px",height:"50px"}},[t("el-image",{staticStyle:{height:"100%"},attrs:{src:e.row.bannerImage,"preview-src-list":[e.row.bannerImage]}})],1)]}}])}),t("el-table-column",{attrs:{prop:"orderByNumber",label:"Location"}}),t("el-table-column",{attrs:{prop:"bannerUrl",label:"Link"}}),t("el-table-column",{attrs:{prop:"scope",label:"operate",width:"220",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleEditor(r.row)}}},[e._v("edit")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDel(r.row)}}},[e._v("delete")])]}}])})],1),t("el-dialog",{attrs:{title:"添加banner",visible:e.showDialog,width:"540px","close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.showDialog=t}}},[t("div",[t("el-form",{ref:"ruleForm",staticClass:"add-form",attrs:{rules:e.rules,model:e.ruleForm,"label-width":"130px"}},[t("el-form-item",{attrs:{label:"Banner picture",required:""}},[t("el-upload",{class:{hide:e.hideUpload},attrs:{action:e.uploadUrl,"on-change":e.handleChange,"on-success":e.handleUpload,"file-list":e.fileImg,multiple:!1,limit:1,accept:"image/png,image/jpg,image/jpeg,image/gif,image/webp","list-type":"picture-card","before-upload":e.handleBefore,"on-remove":e.handleRemove,"on-exceed":e.handExceed,headers:e.uploadHeader}},[t("i",{staticClass:"el-icon-plus"})])],1),t("el-form-item",{attrs:{label:"Link"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"Please enter the jump address"},model:{value:e.ruleForm.bannerUrl,callback:function(t){e.$set(e.ruleForm,"bannerUrl",t)},expression:"ruleForm.bannerUrl"}})],1),t("el-form-item",{attrs:{label:"Sort",prop:"orderByNumber",rules:e.rules.blur}},[t("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"Please enter the sort, the number is small,"},model:{value:e.ruleForm.orderByNumber,callback:function(t){e.$set(e.ruleForm,"orderByNumber",t)},expression:"ruleForm.orderByNumber"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.handleClose()}}},[e._v("Cancel")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitCofirm()}}},[e._v("Sure")])],1)])],1)},n=[],l=r("5530"),i=r("c7eb"),o=r("1da1"),s=(r("14d9"),r("51be")),c={data:function(){return{protocolList:[],showDialog:!1,ruleForm:{bannerImage:"",bannerUrl:"",orderByNumber:""},fileImg:[],limitCount:1,uploadHeader:{certificate:sessionStorage.getItem("token")},uploadUrl:"",rules:{blur:[{required:!0,message:"please enter",trigger:"blur"}],select:[{required:!0,message:"please choose",trigger:"change"}]},hideUpload:!1}},created:function(){this.uploadUrl=s["a"].api+"/file/upload/image",this.fetchGetBanner()},methods:{fetchGetBanner:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.protocolList=[],t.next=3,e.$http.bannerList();case 3:r=t.sent,r&&(e.protocolList=r.records);case 5:case"end":return t.stop()}}),t)})))()},handleAdd:function(){this.fileImg=[],this.hideUpload=!1,this.ruleForm.id="",this.ruleForm.bannerImage="",this.ruleForm.bannerUrl="",this.ruleForm.orderByNumber="",this.showDialog=!0},handleEditor:function(e){var t=Object(l["a"])({},e);this.fileImg=[{url:t.bannerImage}],this.showDialog=!0,this.hideUpload=!0,this.ruleForm=t},handleClose:function(e){e?e():this.showDialog=!1},handleDel:function(e){var t=this;this.$confirm("Are you sure to perform this operation?","hint",{confirmButtonText:"Sure",cancelButtonText:"Cancel",type:"info"}).then(Object(o["a"])(Object(i["a"])().mark((function r(){var a;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$http.bannerDelete({id:e.id});case 2:a=r.sent,a&&(t.fetchGetBanner(),t.$message.success("Successful operation"));case 4:case"end":return r.stop()}}),r)})))).catch((function(e){console.error(e)}))},handleUpload:function(e){if(200==e.code)return this.fileImg.push({url:e.data}),void(this.ruleForm.bannerImage=e.data);this.$message.error("upload failed")},handleBefore:function(e){var t=this,r=e.size/1024/1024<2;return r||t.$message.error("The file is too large, and the file size is less than 2M"),r},handleChange:function(e,t){this.hideUpload=t.length>=this.limitCount},handleRemove:function(e,t){this.hideUpload=t.length>=this.limitCount,this.fileImg=[]},handExceed:function(e){this.$message.error("File can only upload one")},submitCofirm:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(o["a"])(Object(i["a"])().mark((function t(r){var a,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=19;break}if(0!=e.fileImg.length){t.next=4;break}return e.$message.error("Please upload the picture!"),t.abrupt("return");case 4:if(a=Object(l["a"])({},e.ruleForm),a.bannerImage=e.fileImg[0].url,n=null,!e.ruleForm.id){t.next=13;break}return t.next=10,e.$http.bannerUpdate(Object(l["a"])({},a));case 10:n=t.sent,t.next=16;break;case 13:return t.next=15,e.$http.bannerAdd(Object(l["a"])({},a));case 15:n=t.sent;case 16:n&&(e.fetchGetBanner(),e.showDialog=!1,e.$refs["ruleForm"].resetFields(),e.$message.success("Successful operation!"),e.fileImg=[]),t.next=21;break;case 19:return console.log("error submit!!"),t.abrupt("return",!1);case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},u=c,d=(r("5df0"),r("2877")),h=Object(d["a"])(u,a,n,!1,null,"0d503e70",null);t["default"]=h.exports}}]);