(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42ab8c99"],{"007d":function(e,t,r){},3820:function(e,t,r){"use strict";r("007d")},c407:function(e,r,a){"use strict";a.r(r);a("b680");var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-wrapper"},[t("div",{staticClass:"public-list-inputs"},[t("el-input",{staticClass:"public-input",staticStyle:{width:"220px"},attrs:{placeholder:"Enter ID, name",clearable:""},model:{value:e.obscureField,callback:function(t){e.obscureField=t},expression:"obscureField"}}),t("el-input",{staticClass:"public-input",staticStyle:{width:"120px"},attrs:{placeholder:"Input project party",clearable:""},model:{value:e.projectParty,callback:function(t){e.projectParty=t},expression:"projectParty"}}),t("div",{staticClass:"public-date-box"},[t("span",{staticClass:"demonstration"},[e._v(" add time ")]),t("el-date-picker",{attrs:{type:"datetimerange","range-separator":"arrive","start-placeholder":"Starting time","end-placeholder":"End Time"},model:{value:e.addTime,callback:function(t){e.addTime=t},expression:"addTime"}})],1),t("el-button",{staticClass:"public-search",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.fetchNftExternalList()}}},[e._v(" Inquire ")]),t("el-button",{staticClass:"public-search",attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleAdd()}}},[e._v(" Create NFT ")]),t("el-button",{staticClass:"public-search",attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(t){return e.nftExternalFlushed()}}},[e._v(" refresh ")])],1),t("div",{staticClass:"remittance-box"},[t("div",{staticClass:"remittance-amount remittance-more"},[t("div",{staticClass:"remittance-item"},[t("div",{staticClass:"title"},[e._v("Total series")]),t("div",{staticClass:"val"},[e._v(e._s(e.aggregateQuery&&e.aggregateQuery.collNumberTotal))])])])]),t("el-table",{staticClass:"public-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"sort-change":e.sortChange}},[t("el-table-column",{key:"1",attrs:{prop:"id",sortable:"custom",label:"Series ID",align:"center"}}),t("el-table-column",{key:"2",attrs:{prop:"seriesImg",label:"Series diagram",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("div",{staticStyle:{width:"100px",height:"100px"}},[t("el-image",{staticStyle:{height:"100%"},attrs:{src:e.row.seriesImg,"preview-src-list":[e.row.seriesImg]}})],1)]}}])}),t("el-table-column",{key:"3",attrs:{prop:"seriesName",label:"Series name",align:"center"}}),t("el-table-column",{key:"4",attrs:{prop:"contractAddress",label:"contract",align:"center"}}),t("el-table-column",{key:"5",attrs:{prop:"projectParty",label:"Project party",align:"center"}}),t("el-table-column",{key:"6",attrs:{prop:"marketName",label:"market",align:"center"}}),t("el-table-column",{key:"7",attrs:{prop:"chainName",label:"Chain",align:"center"}}),t("el-table-column",{key:"8",attrs:{prop:"issuanceNumber",sortable:"custom",label:"issue number",align:"center"}}),t("el-table-column",{key:"9",attrs:{prop:"inBoxNumber",sortable:"custom",width:"120",label:"Number of income boxes",align:"center"}}),t("el-table-column",{key:"10",attrs:{prop:"floorPrice",sortable:"custom",width:"120",label:"Floor price ($ {'eth'})",align:"center"}}),t("el-table-column",{key:"16",attrs:{prop:"price",sortable:"custom",label:"Floor price ($ {coin})",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((t.row.usdtLastPrice*t.row.floorPrice).toFixed(4))+" ")]}}])}),t("el-table-column",{key:"11",attrs:{prop:"releaseTime",sortable:"custom",width:"140",label:"publish time",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.timeForStr(t.row.releaseTime,"YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),t("el-table-column",{key:"12",attrs:{prop:"relevancyBoxNumber",sortable:"custom",label:"Associated blind box",align:"center"}}),t("el-table-column",{key:"13",attrs:{prop:"createTime",sortable:"custom",width:"140",label:"add time",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.timeForStr(t.row.createTime,"YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),t("el-table-column",{key:"14",attrs:{prop:"refreshTime",sortable:"custom",width:"140",label:"Refresh last time",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.timeForStr(t.row.refreshTime,"YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),t("el-table-column",{key:"15",attrs:{label:"operate",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("span",{staticClass:"blueColor publick-button cursor",on:{click:function(t){return e.approve(r.row)}}},[e._v(" Authorize ")]),t("span",{staticClass:"blueColor publick-button cursor",on:{click:function(t){return e.handleEdit(r.row)}}},[e._v(" edit ")]),t("span",{staticClass:"blueColor publick-button cursor",on:{click:function(t){return e.handleDel(r.row)}}},[e._v(" delete ")])]}}])})],1),e.baseUserPage&&e.baseUserPage.total?t("el-pagination",{staticClass:"public-pagination",attrs:{background:"","current-page":e.page,"page-sizes":e.pagination.pageSizes,"page-size":e.size,layout:" sizes, prev, pager, next, jumper",total:e.baseUserPage.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e(),e.showDialog?t("el-dialog",{attrs:{title:1==e.operatingType?"Create NFT":"Edit NFT",visible:e.showDialog,width:"540px","close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.showDialog=t}}},[t("el-form",{ref:"ruleForm",staticClass:"add-form",attrs:{rules:e.rules,model:e.ruleForm,"label-width":"130px"}},[t("el-form-item",{attrs:{label:"Series name",prop:"seriesName"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"Please enter the series name"},model:{value:e.ruleForm.seriesName,callback:function(t){e.$set(e.ruleForm,"seriesName",t)},expression:"ruleForm.seriesName"}})],1),t("el-form-item",{attrs:{label:"Contract address",prop:"contractAddress"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{disabled:1!=e.operatingType,placeholder:"Please enter the contract address"},model:{value:e.ruleForm.contractAddress,callback:function(t){e.$set(e.ruleForm,"contractAddress",t)},expression:"ruleForm.contractAddress"}},[t("template",{slot:"append"},[t("el-button",{on:{click:function(t){return e.fetchNftSeries()}}},[e._v("Inquire")])],1)],2)],1),t("el-form-item",{attrs:{label:"Series pictures",prop:"seriesImg"}},[t("el-upload",{class:{hide:e.hideUpload},attrs:{action:e.uploadUrl,disabled:1!=e.operatingType,"on-change":e.handleChange,"on-success":e.handleUpload,"file-list":e.fileImg,multiple:!1,limit:1,accept:"image/png,image/jpg,image/jpeg,image/gif,image/webp","list-type":"picture-card","before-upload":e.handleBefore,"on-remove":e.handleRemove,"on-exceed":e.handExceed,headers:e.uploadHeader}},[t("i",{staticClass:"el-icon-plus"})])],1),t("el-form-item",{attrs:{label:"Chain",prop:"chainId"}},[t("el-select",{staticStyle:{width:"300px"},attrs:{disabled:1!=e.operatingType},model:{value:e.ruleForm.chainId,callback:function(t){e.$set(e.ruleForm,"chainId",t)},expression:"ruleForm.chainId"}},e._l(e.chainList,(function(r,a){return t("el-option",{key:a,attrs:{label:r.chainName,value:r.chainId}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(r.chainName))]),t("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(e._s(r.type))])])})),1)],1),t("el-form-item",{attrs:{label:"Choose the market",prop:"marketNames"}},[t("el-checkbox-group",{model:{value:e.ruleForm.marketNames,callback:function(t){e.$set(e.ruleForm,"marketNames",t)},expression:"ruleForm.marketNames"}},e._l(e.markes,(function(r,a){return t("el-checkbox",{key:a,attrs:{label:r.marketName,border:""}},[e._v(" "+e._s(r.marketName)+" ")])})),1)],1),t("el-form-item",{attrs:{label:"NFT type",prop:"seriesNftType"}},[t("el-select",{staticStyle:{width:"300px"},model:{value:e.ruleForm.seriesNftType,callback:function(t){e.$set(e.ruleForm,"seriesNftType",t)},expression:"ruleForm.seriesNftType"}},[t("el-option",{attrs:{label:"isC721",value:"ERC721"}}),t("el-option",{attrs:{label:"isC1155",value:"ERC1155"}})],1)],1),t("el-form-item",{attrs:{label:"Keyword",prop:"keywords"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{disabled:1!=e.operatingType,placeholder:"Please enter the name"},model:{value:e.ruleForm.keywords,callback:function(t){e.$set(e.ruleForm,"keywords",t)},expression:"ruleForm.keywords"}})],1),t("el-form-item",{attrs:{label:"Project party"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"Please enter the name"},model:{value:e.ruleForm.projectParty,callback:function(t){e.$set(e.ruleForm,"projectParty",t)},expression:"ruleForm.projectParty"}})],1),t("el-form-item",{attrs:{label:"Total distribution",prop:"issuanceNumber"}},[t("el-input",{staticStyle:{width:"300px"},attrs:{type:"number",placeholder:"Please enter the total amount of distribution"},model:{value:e.ruleForm.issuanceNumber,callback:function(t){e.$set(e.ruleForm,"issuanceNumber",e._n(t))},expression:"ruleForm.issuanceNumber"}})],1),t("el-form-item",{attrs:{label:"describe"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:4},placeholder:"Please enter the description"},model:{value:e.ruleForm.remark,callback:function(t){e.$set(e.ruleForm,"remark",t)},expression:"ruleForm.remark"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.handleClose()}}},[e._v("Cancel")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v("Sure")])],1)],1):e._e()],1)},n=[],l=a("5530"),i=a("c7eb"),o=a("1da1"),c=(a("a15b"),a("14d9"),a("b0c0"),a("bc3a")),u=a.n(c),d=a("ed08"),p=a("1b80"),m=a("51be"),h=a("0acd"),f=a("a938"),b=a("f31c"),g=a("eb57"),k=a("c0d8"),y=a.n(k),w={name:"ExternalNftSeries",components:{},data:function(){return{walletAddress:"",showDialog:!1,operatingType:!1,obscureField:null,projectParty:null,addTime:null,sortData:{orderBy:null,orderType:null},page:1,size:20,tableData:null,aggregateQuery:{},baseUserPage:null,uploadUrl:"",fileImg:[],limitCount:1,hideUpload:!1,uploadHeader:{certificate:sessionStorage.getItem("token")},ruleForm:{chainId:null,marketNames:[],seriesName:null,seriesImg:null,contractAddress:null,keywords:null,projectParty:null,issuanceNumber:null,seriesNftType:""},rules:{},markes:[],chainList:h["a"]}},mixins:[p["a"]],methods:{timeForStr:d["h"],fetchMarketManagerList:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.getMarketManagerList({page:1,size:9999});case 2:r=t.sent,r&&(e.markes=r.records);case 4:case"end":return t.stop()}}),t)})))()},connectMetaMask:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function r(){var a,s,n;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:a=e,s=new y.a(window.ethereum),n=window.ethereum,"undefined"===typeof n?openUrl("https://metamask.app.link/dapp/".concat(window.location.origin)):n.enable().then(function(){var e=Object(o["a"])(Object(i["a"])().mark((function e(t){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:s=new y.a(window.ethereum),s.eth.defaultAccount=t[0],a.walletAddress=t[0];case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){"User rejected provider access"===e||ElMessage.error(t("airdrop.failedTips"))}));case 4:case"end":return r.stop()}}),r)})))()},approve:function(e){var t=this;return Object(o["a"])(Object(i["a"])().mark((function r(){var a,s,n,l,o,c,u;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.connectMetaMask();case 2:return r.next=4,window.ethereum.request({method:"eth_requestAccounts"});case 4:return r.sent,a="ERC1155"==e.seriesNftType,s=new y.a(window.ethereum),n=e.contractAddress,l=t.walletAddress,o=new s.eth.Contract(a?b:f,n),c=g["a"].nftHelpAddress,r.next=13,o.methods.isApprovedForAll(l,c).call();case 13:if(u=r.sent,u){r.next=19;break}return r.next=17,o.methods.setApprovalForAll(c,!0).send({from:l});case 17:r.next=20;break;case 19:t.$message.success("isApproved");case 20:case"end":return r.stop()}}),r)})))()},searchFun:function(){var e=this.addTime,t=null,r=null;return e&&e[0]&&(t=Object(d["h"])(e[0],"YYYY-MM-DD HH:mm:ss")),e&&e[1]&&(r=Object(d["h"])(e[1],"YYYY-MM-DD HH:mm:ss")),{obscureField:this.obscureField,projectParty:this.projectParty,startTime:t,endTime:r}},sortChange:function(e){e.column;var t=e.prop,r=e.order;this.sortData.orderBy=t,this.sortData.orderType="descending"==r?"DESC":"ASC",r||(this.sortData.orderType=null),this.fetchNftExternalList()},fetchNftExternalList:function(){var e=arguments,t=this;return Object(o["a"])(Object(i["a"])().mark((function r(){var a,s,n,o,c,u,d,p;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=!(e.length>0&&void 0!==e[0])||e[0],s=t.searchFun(),n=t.sortData,o=t.size,c=t.page,a&&(t.page=1,c=1),u=Object(l["a"])(Object(l["a"])(Object(l["a"])({},{size:o,page:c}),n),s),r.next=8,t.$http.getNftExternalList(u);case 8:return d=r.sent,d&&(t.baseUserPage=d,t.tableData=d.records),delete u.size,delete u.page,r.next=14,t.$http.getNftExternalStatistics(u);case 14:p=r.sent,p&&(t.aggregateQuery=p);case 16:case"end":return r.stop()}}),r)})))()},nftExternalFlushed:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.nftExternalFlushed();case 2:r=t.sent,r&&(e.fetchNftExternalList(),e.$message.success("Successful operation"));case 4:case"end":return t.stop()}}),t)})))()},handleAdd:function(){this.operatingType=1,this.hideUpload=!1,this.showDialog=!0},handleEdit:function(e){this.ruleForm=Object(l["a"])(Object(l["a"])({},e),{},{marketNames:e.marketNames.split(",")}),this.fileImg=[{url:e.seriesImg}],this.operatingType=2,this.hideUpload=!0,this.showDialog=!0},handleDel:function(e){var t=this;this.$confirm("OK to delete the series『".concat(e.seriesName||e.id,"』?"),"hint",{confirmButtonText:"Sure",cancelButtonText:"Cancel",type:"info"}).then(Object(o["a"])(Object(i["a"])().mark((function r(){var a;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$http.nftExternalDel({id:e.id});case 2:a=r.sent,a&&(t.fetchNftExternalList(),t.$message.success("Successful operation"));case 4:case"end":return r.stop()}}),r)})))).catch((function(e){console.error(e)}))},handleClose:function(e){this.ruleForm={chainId:null,marketNames:[],seriesName:null,seriesImg:null,contractAddress:null,keywords:null,projectParty:null,issuanceNumber:null,seriesNftType:""},this.fileImg=[],this.$refs["ruleForm"].clearValidate(),e?e():this.showDialog=!1},handleUpload:function(e){if(200==e.code)return this.fileImg.push({url:e.data}),void(this.ruleForm.seriesImg=e.data);this.$message.error("upload failed")},handleBefore:function(e){var t=this,r=e.size/1024/1024<2;return r||t.$message.error("The file is too large, and the file size is less than 2M"),r},handleChange:function(e,t){this.hideUpload=t.length>=this.limitCount},handleRemove:function(e,t){this.hideUpload=t.length>=this.limitCount,this.fileImg=[]},handExceed:function(e){this.$message.error("File can only upload one")},submitForm:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(o["a"])(Object(i["a"])().mark((function t(r){var a,s,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=21;break}if(0!=e.fileImg.length){t.next=4;break}return e.$message.error("Please upload the picture!"),t.abrupt("return");case 4:if(a=e.ruleForm.marketNames,s=Object(l["a"])(Object(l["a"])({},e.ruleForm),{},{marketNames:a&&a.join(",")}),n=null,1!=e.operatingType){t.next=15;break}return s.marketNames=a&&a.join(","),s.seriesImg=e.fileImg[0].url,t.next=12,e.$http.nftExternalAdd(Object(l["a"])({},s));case 12:n=t.sent,t.next=18;break;case 15:return t.next=17,e.$http.nftExternalUpdate(Object(l["a"])({},s));case 17:n=t.sent;case 18:n&&(e.handleClose(),e.$refs["ruleForm"].resetFields(),e.$message.success("Successful operation!"),e.fetchNftExternalList(),e.fileImg=[]),t.next=23;break;case 21:return console.log("error submit!!"),t.abrupt("return",!1);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},fetchNftSeries:function(){var e=this,t=this.ruleForm,r=t.chainId,a=t.contractAddress;if(r){var s=m["a"].api+"/nft-external-series/assetContract/goerli/";1==r&&(s=m["a"].api+"/nft-external-series/assetContract/eth/"),u.a.get(s+a,{responseType:"json",headers:{"X-API-KEY":"3eb9844d094945f288c104c770365ac8",certificate:sessionStorage.getItem("token")}}).then((function(t){if(200==t.status){var r=t.data;return e.fileImg=[{url:r.image_url}],e.ruleForm.seriesName=r.name,e.ruleForm.seriesImg=r.image_url,void(e.ruleForm.keywords=r.collection.slug)}e.$message.error("Inquiry fails, please check whether the contract address is correct")})).catch((function(t){e.$message.error("Inquiry fails, please check whether the contract address is correct"),console.log(t)}))}else this.$message.warning("Please select the network")},handleSizeChange:function(e){this.size=e,this.fetchNftExternalList()},handleCurrentChange:function(e){this.page=e,this.fetchNftExternalList(!1)}},created:function(){this.fetchNftExternalList(),this.fetchMarketManagerList(),this.uploadUrl=m["a"].api+"/file/upload/image",this.rules={chainId:[{required:!0,message:"Please select the chain",trigger:["blur","change"]}],marketNames:[{required:!0,message:"Please choose the market",trigger:["blur","change"]}],seriesName:[{required:!0,message:"Please enter the series name",trigger:["blur","change"]}],seriesImg:[{required:!0,message:"Please select NFT pictures",trigger:["blur","change"]}],seriesNftType:[{required:!0,message:"Please select NFT type",trigger:["blur","change"]}],contractAddress:[{required:!0,message:"Please enter the contract address",trigger:["blur","change"]}],keywords:[{required:!0,message:"Please enter key words",trigger:["blur","change"]}],issuanceNumber:[{required:!0,message:"Please enter the number of issuance",trigger:["blur","change"]}]}},computed:{coin:function(){return this.$store.getters.coinConfig},userType:function(){return this.$store.getters.accountConfig}},mounted:function(){},updated:function(){},beforeDestroy:function(){}},v=w,x=(a("3820"),a("2877")),F=Object(x["a"])(v,s,n,!1,null,"01bd9ed3",null);r["default"]=F.exports},eb57:function(e,t,r){"use strict";t["a"]={MultiSign:"0xf5293915f239a8bd6b1fc00c3d5510abd6e97774",nftHelpAddress:"0x0636ac626382270f428d23aae75957418a5344fe"}}}]);