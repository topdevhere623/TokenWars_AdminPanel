(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-643ee746"],{"3c5a":function(e,t,a){"use strict";a.r(t);a("b680");var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-wrapper"},[t("div",{staticClass:"public-list-inputs"},[t("el-input",{staticClass:"public-input",staticStyle:{width:"220px"},attrs:{placeholder:"Enter ID, name",clearable:""},model:{value:e.obscureField,callback:function(t){e.obscureField=t},expression:"obscureField"}}),t("div",{staticClass:"public-date-box"},[t("span",{staticClass:"demonstration"},[e._v(" add time ")]),t("el-date-picker",{attrs:{type:"datetimerange","range-separator":"arrive","start-placeholder":"Starting time","end-placeholder":"End Time"},model:{value:e.addTime,callback:function(t){e.addTime=t},expression:"addTime"}})],1),t("el-button",{staticClass:"public-search",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getTableList()}}},[e._v(" Inquire ")]),t("el-button",{staticClass:"public-search",attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleAdd()}}},[e._v(" Token ")]),t("el-button",{staticClass:"public-search",attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(t){return e.refreshFunc()}}},[e._v(" refresh ")])],1),t("div",{staticClass:"remittance-box"},[t("div",{staticClass:"remittance-amount remittance-more"},[t("div",{staticClass:"remittance-item"},[t("div",{staticClass:"title"},[e._v("Total currency")]),t("div",{staticClass:"val"},[e._v(e._s(e.aggregateQuery&&e.aggregateQuery.collNumberTotal))])]),t("div",{staticClass:"remittance-item"},[t("div",{staticClass:"title"},[e._v("total value")]),t("div",{staticClass:"val"},[e._v(e._s(e.aggregateQuery&&e.aggregateQuery.collNumberTotal))])])])]),t("el-table",{staticClass:"public-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"sort-change":e.sortChange}},[t("el-table-column",{key:"1",attrs:{prop:"id",sortable:"custom",label:"Token ID",align:"center"}}),t("el-table-column",{key:"2",attrs:{prop:"coinImage",label:"Token map",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("div",{staticStyle:{width:"100px",height:"100px"}},[t("el-image",{staticStyle:{height:"100%"},attrs:{src:e.row.coinImage,"preview-src-list":[e.row.coinImage]}})],1)]}}])}),t("el-table-column",{key:"3",attrs:{prop:"seriesName",label:"Token name",align:"center"}}),t("el-table-column",{key:"4",attrs:{prop:"contractAddress",label:"contract",align:"center"}}),t("el-table-column",{key:"5",attrs:{prop:"chainName",label:"Chain",align:"center"}}),t("el-table-column",{key:"6",attrs:{prop:"price",sortable:"custom",label:"quantity",align:"center"}}),t("el-table-column",{key:"7",attrs:{prop:"price",sortable:"custom",label:"ETH value",align:"center"}}),t("el-table-column",{key:"16",attrs:{prop:"price",sortable:"custom",label:"".concat(e.Coin," Value"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((t.row.usdtLastPrice*t.row.price).toFixed(4))+" ")]}}])}),t("el-table-column",{key:"8",attrs:{prop:"relevancyBoxNumber",sortable:"custom",label:"Associated blind box",align:"center"}}),t("el-table-column",{key:"9",attrs:{prop:"openNumber",sortable:"custom",width:"120",label:"Number of times",align:"center"}}),t("el-table-column",{key:"10",attrs:{prop:"reclaimRate",sortable:"custom",width:"120",label:"Recycling ratio",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(100*t.row.reclaimRate)+" ")]}}])}),t("el-table-column",{key:"13",attrs:{prop:"createTime",sortable:"custom",width:"140",label:"add time",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.timeForStr(t.row.createTime,"YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),t("el-table-column",{key:"14",attrs:{prop:"refreshTime",sortable:"custom",width:"140",label:"Refresh last time",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.timeForStr(t.row.refreshTime,"YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),t("el-table-column",{key:"15",attrs:{label:"operate",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"blueColor publick-button cursor"},[e._v(" Detail ")]),t("span",{staticClass:"blueColor publick-button cursor",on:{click:function(t){return e.handleDel(a.row)}}},[e._v(" delete ")])]}}])})],1),e.baseUserPage&&e.baseUserPage.total?t("el-pagination",{staticClass:"public-pagination",attrs:{background:"","current-page":e.page,"page-sizes":e.pagination.pageSizes,"page-size":e.size,layout:" sizes, prev, pager, next, jumper",total:e.baseUserPage.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e(),e.showDialog?t("el-dialog",{attrs:{title:1==e.operatingType?"Token":"Tokens",visible:e.showDialog,width:"540px","close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.showDialog=t}}},[t("el-form",{ref:"ruleForm",staticClass:"add-form",attrs:{rules:e.rules,model:e.ruleForm,"label-width":"130px"}},[t("el-form-item",{attrs:{label:"name",prop:"seriesName",rules:e.rules.blur}},[t("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"Please enter the name"},model:{value:e.ruleForm.seriesName,callback:function(t){e.$set(e.ruleForm,"seriesName",t)},expression:"ruleForm.seriesName"}})],1),t("el-form-item",{attrs:{label:"Contract address",prop:"contractAddress",rules:e.rules.blur}},[t("el-input",{staticStyle:{width:"300px"},attrs:{disabled:1!=e.operatingType,placeholder:"Please enter the contract address"},model:{value:e.ruleForm.contractAddress,callback:function(t){e.$set(e.ruleForm,"contractAddress",t)},expression:"ruleForm.contractAddress"}},[t("template",{slot:"append"},[t("el-button",{on:{click:function(t){return e.fetchNftSeries()}}},[e._v("Inquire")])],1)],2)],1),t("el-form-item",{attrs:{label:"Currency",prop:"coinName",rules:e.rules.select}},[t("el-select",{staticStyle:{width:"300px"},attrs:{disabled:1!=e.operatingType},model:{value:e.ruleForm.coinName,callback:function(t){e.$set(e.ruleForm,"coinName",t)},expression:"ruleForm.coinName"}},[t("el-option",{attrs:{label:"eth",value:"ETH"}})],1)],1),t("el-form-item",{attrs:{label:"picture",prop:"coinImage",rules:e.rules.select}},[t("el-upload",{class:{hide:e.hideUpload},attrs:{action:e.uploadUrl,disabled:1!=e.operatingType,"on-change":e.handleChange,"on-success":e.handleUpload,"file-list":e.fileImg,multiple:!1,limit:1,accept:"image/png,image/jpg,image/jpeg,image/gif,image/webp","list-type":"picture-card","before-upload":e.handleBefore,"on-remove":e.handleRemove,"on-exceed":e.handExceed,headers:e.uploadHeader}},[t("i",{staticClass:"el-icon-plus"})])],1),t("el-form-item",{attrs:{label:"Chain",prop:"chainId",rules:e.rules.select}},[t("el-select",{staticStyle:{width:"300px"},attrs:{disabled:1!=e.operatingType},model:{value:e.ruleForm.chainId,callback:function(t){e.$set(e.ruleForm,"chainId",t)},expression:"ruleForm.chainId"}},e._l(e.chainList,(function(a,r){return t("el-option",{key:r,attrs:{label:a.chainName,value:a.chainId}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(a.chainName))]),t("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(e._s(a.type))])])})),1)],1),t("el-form-item",{attrs:{label:"value",prop:"price",rules:e.rules.blur}},[t("el-input",{staticStyle:{width:"300px"},attrs:{disabled:"COIN"!==e.ruleForm.seriesType&&1!=e.operatingType,type:"number",placeholder:"Please enter value"},model:{value:e.ruleForm.price,callback:function(t){e.$set(e.ruleForm,"price",t)},expression:"ruleForm.price"}},[t("template",{slot:"append"},[e._v(e._s(e.ruleForm.coin))])],2)],1),t("el-form-item",{attrs:{label:"Recycling ratio",prop:"reclaimRate",rules:e.rules.blur}},[t("el-input",{staticStyle:{width:"300px"},attrs:{type:"number",placeholder:"Please enter the recycling ratio"},model:{value:e.ruleForm.reclaimRate,callback:function(t){e.$set(e.ruleForm,"reclaimRate",t)},expression:"ruleForm.reclaimRate"}},[t("template",{slot:"append"},[e._v("%")])],2)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.handleClose()}}},[e._v("Cancel")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v("Sure")])],1)],1):e._e()],1)},l=[],s=a("c7eb"),n=a("5530"),i=a("1da1"),o=(a("4de4"),a("14d9"),a("b0c0"),a("d3b7"),a("bc3a")),c=a.n(o),u=a("ed08"),d=a("1b80"),p=a("51be"),m=a("0acd"),h={name:"ExternalTokenManagement",components:{},data:function(){return{walletAddress:"",showDialog:!1,operatingType:!1,obscureField:null,addTime:null,sortData:{orderBy:null,orderType:null},page:1,size:20,tableData:null,aggregateQuery:{},baseUserPage:null,uploadUrl:"",fileImg:[],limitCount:1,hideUpload:!1,uploadHeader:{certificate:sessionStorage.getItem("token")},ruleForm:{seriesName:null,coinName:null,coinImage:null,contractAddress:null,chainId:null,chainName:null,reclaimRate:null,price:null,coin:"ETH"},rules:{select:[{required:!0,message:"please choose",trigger:["blur","change"]}],blur:[{required:!0,message:"please enter",trigger:["blur","change"]}]},chainList:m["a"]}},mixins:[d["a"]],methods:{timeForStr:u["h"],searchFun:function(){var e=this.addTime,t=null,a=null;return e&&e[0]&&(t=Object(u["h"])(e[0],"YYYY-MM-DD HH:mm:ss")),e&&e[1]&&(a=Object(u["h"])(e[1],"YYYY-MM-DD HH:mm:ss")),{obscureField:this.obscureField,startTime:t,endTime:a}},sortChange:function(e){e.column;var t=e.prop,a=e.order;this.sortData.orderBy=t,this.sortData.orderType="descending"==a?"DESC":"ASC",a||(this.sortData.orderType=null),this.getTableList()},getTableList:function(){var e=arguments,t=this;return Object(i["a"])(Object(s["a"])().mark((function a(){var r,l,i,o,c,u,d,p;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=!(e.length>0&&void 0!==e[0])||e[0],l=t.searchFun(),i=t.sortData,o=t.size,c=t.page,r&&(t.page=1,c=1),u=Object(n["a"])(Object(n["a"])(Object(n["a"])({},{size:o,page:c}),i),l),a.next=8,t.$http.externalCoinPageList(u);case 8:return d=a.sent,d&&(t.baseUserPage=d,t.tableData=d.records),delete u.size,delete u.page,a.next=14,t.$http.getNftExternalStatistics(u);case 14:p=a.sent,p&&(t.aggregateQuery=p);case 16:case"end":return a.stop()}}),a)})))()},refreshFunc:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.externalCoinRefresh();case 2:a=t.sent,a&&(e.getTableList(),e.$message.success("Successful operation"));case 4:case"end":return t.stop()}}),t)})))()},handleAdd:function(){this.operatingType=1,this.hideUpload=!1,this.showDialog=!0},handleEdit:function(e){this.ruleForm=Object(n["a"])({},e),this.fileImg=[{url:e.coinImage}],this.operatingType=2,this.hideUpload=!0,this.showDialog=!0},handleDel:function(e){var t=this;this.$confirm("OK to delete the series『".concat(e.seriesName||e.id,"』?"),"hint",{confirmButtonText:"Sure",cancelButtonText:"Cancel",type:"info"}).then(Object(i["a"])(Object(s["a"])().mark((function a(){var r;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.externalCoinDelete({id:e.id});case 2:r=a.sent,r&&(t.getTableList(),t.$message.success("Successful operation"));case 4:case"end":return a.stop()}}),a)})))).catch((function(e){console.error(e)}))},handleClose:function(e){this.fileImg=[],this.$refs["ruleForm"].clearValidate(),e?e():this.showDialog=!1},handleUpload:function(e){if(200==e.code)return this.fileImg.push({url:e.data}),void(this.ruleForm.coinImage=e.data);this.$message.error("upload failed")},handleBefore:function(e){var t=this,a=e.size/1024/1024<2;return a||t.$message.error("The file is too large, and the file size is less than 2M"),a},handleChange:function(e,t){this.hideUpload=t.length>=this.limitCount},handleRemove:function(e,t){this.hideUpload=t.length>=this.limitCount,this.fileImg=[]},handExceed:function(e){this.$message.error("File can only upload one")},submitForm:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(i["a"])(Object(s["a"])().mark((function t(a){var r,l;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=21;break}if(0!=e.fileImg.length){t.next=4;break}return e.$message.error("Please upload the picture!"),t.abrupt("return");case 4:if(r=Object(n["a"])({},e.ruleForm),l=null,1!=e.operatingType){t.next=15;break}return r.chainName=e.chainList.filter((function(e){return e.chainId==r.chainId}))[0].chainName,r.coinImage=e.fileImg[0].url,r.reclaimRate=r.reclaimRate/100,t.next=12,e.$http.externalCoinAdd(Object(n["a"])({},r));case 12:l=t.sent,t.next=18;break;case 15:return t.next=17,e.$http.nftExternalUpdate(Object(n["a"])({},r));case 17:l=t.sent;case 18:l&&(e.handleClose(),e.$refs["ruleForm"].resetFields(),e.$message.success("Successful operation!"),e.getTableList(),e.fileImg=[]),t.next=23;break;case 21:return console.log("error submit!!"),t.abrupt("return",!1);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},fetchNftSeries:function(){var e=this,t=this.ruleForm,a=t.chainId,r=t.contractAddress;if(a){var l=p["a"].api+"/nft-external-series/assetContract/goerli/";1==a&&(l=p["a"].api+"/nft-external-series/assetContract/eth/"),c.a.get(l+r,{responseType:"json",headers:{"X-API-KEY":"3eb9844d094945f288c104c770365ac8",certificate:sessionStorage.getItem("token")}}).then((function(t){if(200==t.status){var a=t.data;return e.fileImg=[{url:a.image_url}],e.ruleForm.seriesName=a.name,e.ruleForm.coinImage=a.image_url,void(e.ruleForm.keywords=a.collection.slug)}e.$message.error("Inquiry fails, please check whether the contract address is correct")})).catch((function(t){e.$message.error("Inquiry fails, please check whether the contract address is correct"),console.log(t)}))}else this.$message.warning("Please select the network")},handleSizeChange:function(e){this.size=e,this.getTableList()},handleCurrentChange:function(e){this.page=e,this.getTableList(!1)}},created:function(){this.getTableList(),this.uploadUrl=p["a"].api+"/file/upload/image"},computed:{coin:function(){return this.$store.getters.coinConfig},userType:function(){return this.$store.getters.accountConfig}},mounted:function(){},updated:function(){},beforeDestroy:function(){}},b=h,g=(a("832d"),a("2877")),f=Object(g["a"])(b,r,l,!1,null,"1b2dfb1c",null);t["default"]=f.exports},"832d":function(e,t,a){"use strict";a("99eb")},"99eb":function(e,t,a){}}]);